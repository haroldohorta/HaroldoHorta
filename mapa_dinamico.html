<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Atlas SUR DAO - Haroldo Horta</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body, html { margin: 0; padding: 0; height: 100%; background: #0f0f0f; font-family: 'Courier New', monospace; }
        #map { height: 100%; width: 100%; }
        .popup-img { width: 100%; border: 1px solid #444; margin-top: 5px; }
        .btn-portafolio {
            width: 100%; background: #222; color: #eee; border: 1px solid #444;
            padding: 8px; cursor: pointer; margin-top: 8px; font-family: inherit;
        }
    </style>
</head>
<body>
<div id="map"></div>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    const map = L.map('map').setView([-30, -70], 4);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);

    const getStyle = (capa) => {
        if(capa === 'Corresponsal') return {color: "#ff4d4d"};
        if(capa === 'Libre Vuelo') return {color: "#4d94ff"};
        return {color: "#ffdb4d"}; // Editorial
    };

    fetch('puntos_mapa.json') // Busca el JSON en la raÃ­z
        .then(res => res.json())
        .then(data => {
            data.forEach(punto => {
                const marker = L.circleMarker([punto.lat, punto.lon], {
                    radius: 7, fillColor: getStyle(punto.capa).color, color: "#000", weight: 1, fillOpacity: 0.8
                }).addTo(map);

                const carpeta = punto.thumb.split('/')[2]; 
                marker.bindPopup(`
                    <div style="text-align:center; background:#1a1a1a; color:white; padding:10px;">
                        <img src="${punto.thumb}" class="popup-img" style="width:150px">
                        <div style="font-size:10px; margin:5px 0;">${punto.id}</div>
                        <button class="btn-portafolio" onclick="window.location.href='galeria.html?zona=${carpeta}'">
                            ABRIR PORTAFOLIO ðŸ“‚
                        </button>
                    </div>
                `);
            });
        });
</script>
</body>
</html>
